version: '3.8'

services:
  bills-app:
    build: .
    ports:
      - "5000:5000"
    restart: unless-stopped
    command: >
      sh -c "
        if [ -f /app/requirements.txt ]; then
          pip install -r /app/requirements.txt
        fi &&
        gunicorn --bind 0.0.0.0:5000 --workers 1 --worker-class sync server.app:app
      "
    volumes:
      # Persistent data storage for all databases
      - ./data:/app/data
      # Mount the shared database directory
      - ./dbs:/app/dbs
